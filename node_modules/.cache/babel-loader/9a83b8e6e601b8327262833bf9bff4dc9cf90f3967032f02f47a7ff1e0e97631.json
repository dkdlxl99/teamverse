{"ast":null,"code":"import { Client } from \"@stomp/stompjs\";\nlet stompClient = null;\nlet reconnectAttempts = 0;\nconst MAX_RECONNECT_ATTEMPTS = 5; // ‚úÖ ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÌöüÏàò\n\nexport const getStompClient = () => {\n  if (stompClient && stompClient.connected) {\n    console.log(\"‚ö†Ô∏è Í∏∞Ï°¥ STOMP ClientÍ∞Ä Ïù¥ÎØ∏ Ïó∞Í≤∞ÎêòÏñ¥ ÏûàÏùå.\");\n    return stompClient;\n  }\n  if (stompClient && stompClient.active) {\n    console.log(\"‚ö†Ô∏è Í∏∞Ï°¥ STOMP ClientÍ∞Ä Ïù¥ÎØ∏ ÌôúÏÑ±ÌôîÎê®.\");\n    return stompClient;\n  }\n  console.log(\"üü¢ ÏÉàÎ°úÏö¥ STOMP Client ÏÉùÏÑ±\");\n  stompClient = new Client({\n    brokerURL: \"ws://localhost:8082/ws\",\n    connectHeaders: {\n      Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n    },\n    debug: msg => console.log(\"üìå STOMP Debug:\", msg),\n    reconnectDelay: 5000,\n    heartbeatIncoming: 4000,\n    heartbeatOutgoing: 4000\n  });\n  stompClient.onConnect = () => {\n    console.log(\"‚úÖ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ!\");\n    reconnectAttempts = 0;\n  };\n  stompClient.onStompError = frame => {\n    console.error(\"üö® STOMP Ïò§Î•ò Î∞úÏÉù:\", frame.headers[\"message\"]);\n  };\n  stompClient.onWebSocketError = error => {\n    console.error(\"üö® WebSocket Ïó∞Í≤∞ Ïò§Î•ò:\", error);\n    reconnectAttempts++;\n    if (reconnectAttempts >= MAX_RECONNECT_ATTEMPTS) {\n      console.warn(\"üõë ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ Ï¥àÍ≥º. WebSocket Ïû¨Ïó∞Í≤∞ Ï§ëÎã®.\");\n      stompClient.deactivate();\n    }\n  };\n  stompClient.onDisconnect = () => {\n    console.warn(\"‚ö†Ô∏è WebSocket Ïó∞Í≤∞ Ï¢ÖÎ£åÎê®!\");\n  };\n  return stompClient;\n};","map":{"version":3,"names":["Client","stompClient","reconnectAttempts","MAX_RECONNECT_ATTEMPTS","getStompClient","connected","console","log","active","brokerURL","connectHeaders","Authorization","localStorage","getItem","debug","msg","reconnectDelay","heartbeatIncoming","heartbeatOutgoing","onConnect","onStompError","frame","error","headers","onWebSocketError","warn","deactivate","onDisconnect"],"sources":["/Users/woo/Documents/git_local/react/0213/src/api/websocket.js"],"sourcesContent":["import { Client } from \"@stomp/stompjs\";\n\nlet stompClient = null;\nlet reconnectAttempts = 0;\nconst MAX_RECONNECT_ATTEMPTS = 5; // ‚úÖ ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÌöüÏàò\n\nexport const getStompClient = () => {\n    if (stompClient && stompClient.connected) {\n        console.log(\"‚ö†Ô∏è Í∏∞Ï°¥ STOMP ClientÍ∞Ä Ïù¥ÎØ∏ Ïó∞Í≤∞ÎêòÏñ¥ ÏûàÏùå.\");\n        return stompClient;\n    }\n\n    if (stompClient && stompClient.active) {\n        console.log(\"‚ö†Ô∏è Í∏∞Ï°¥ STOMP ClientÍ∞Ä Ïù¥ÎØ∏ ÌôúÏÑ±ÌôîÎê®.\");\n        return stompClient;\n    }\n\n    console.log(\"üü¢ ÏÉàÎ°úÏö¥ STOMP Client ÏÉùÏÑ±\");\n    stompClient = new Client({\n        brokerURL: \"ws://localhost:8082/ws\",\n        connectHeaders: {\n            Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n        },\n        debug: (msg) => console.log(\"üìå STOMP Debug:\", msg),\n        reconnectDelay: 5000,\n        heartbeatIncoming: 4000,\n        heartbeatOutgoing: 4000,\n    });\n\n    stompClient.onConnect = () => {\n        console.log(\"‚úÖ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ!\");\n        reconnectAttempts = 0;\n    };\n\n    stompClient.onStompError = (frame) => {\n        console.error(\"üö® STOMP Ïò§Î•ò Î∞úÏÉù:\", frame.headers[\"message\"]);\n    };\n\n    stompClient.onWebSocketError = (error) => {\n        console.error(\"üö® WebSocket Ïó∞Í≤∞ Ïò§Î•ò:\", error);\n        reconnectAttempts++;\n        if (reconnectAttempts >= MAX_RECONNECT_ATTEMPTS) {\n            console.warn(\"üõë ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ Ï¥àÍ≥º. WebSocket Ïû¨Ïó∞Í≤∞ Ï§ëÎã®.\");\n            stompClient.deactivate();\n        }\n    };\n\n    stompClient.onDisconnect = () => {\n        console.warn(\"‚ö†Ô∏è WebSocket Ïó∞Í≤∞ Ï¢ÖÎ£åÎê®!\");\n    };\n\n    return stompClient;\n};\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,gBAAgB;AAEvC,IAAIC,WAAW,GAAG,IAAI;AACtB,IAAIC,iBAAiB,GAAG,CAAC;AACzB,MAAMC,sBAAsB,GAAG,CAAC,CAAC,CAAC;;AAElC,OAAO,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAChC,IAAIH,WAAW,IAAIA,WAAW,CAACI,SAAS,EAAE;IACtCC,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;IAC9C,OAAON,WAAW;EACtB;EAEA,IAAIA,WAAW,IAAIA,WAAW,CAACO,MAAM,EAAE;IACnCF,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;IAC3C,OAAON,WAAW;EACtB;EAEAK,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;EACrCN,WAAW,GAAG,IAAID,MAAM,CAAC;IACrBS,SAAS,EAAE,wBAAwB;IACnCC,cAAc,EAAE;MACZC,aAAa,EAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;IAChE,CAAC;IACDC,KAAK,EAAGC,GAAG,IAAKT,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEQ,GAAG,CAAC;IACnDC,cAAc,EAAE,IAAI;IACpBC,iBAAiB,EAAE,IAAI;IACvBC,iBAAiB,EAAE;EACvB,CAAC,CAAC;EAEFjB,WAAW,CAACkB,SAAS,GAAG,MAAM;IAC1Bb,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;IACjCL,iBAAiB,GAAG,CAAC;EACzB,CAAC;EAEDD,WAAW,CAACmB,YAAY,GAAIC,KAAK,IAAK;IAClCf,OAAO,CAACgB,KAAK,CAAC,iBAAiB,EAAED,KAAK,CAACE,OAAO,CAAC,SAAS,CAAC,CAAC;EAC9D,CAAC;EAEDtB,WAAW,CAACuB,gBAAgB,GAAIF,KAAK,IAAK;IACtChB,OAAO,CAACgB,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC3CpB,iBAAiB,EAAE;IACnB,IAAIA,iBAAiB,IAAIC,sBAAsB,EAAE;MAC7CG,OAAO,CAACmB,IAAI,CAAC,oCAAoC,CAAC;MAClDxB,WAAW,CAACyB,UAAU,CAAC,CAAC;IAC5B;EACJ,CAAC;EAEDzB,WAAW,CAAC0B,YAAY,GAAG,MAAM;IAC7BrB,OAAO,CAACmB,IAAI,CAAC,sBAAsB,CAAC;EACxC,CAAC;EAED,OAAOxB,WAAW;AACtB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}