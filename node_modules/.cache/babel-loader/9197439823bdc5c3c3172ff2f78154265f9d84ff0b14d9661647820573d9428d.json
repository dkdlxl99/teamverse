{"ast":null,"code":"import { Client } from \"@stomp/stompjs\";\nlet stompClient = null;\nlet reconnectAttempts = 0;\nconst MAX_RECONNECT_ATTEMPTS = 5; // ‚úÖ ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÌöüÏàò\n\nexport const getStompClient = () => {\n  if (!stompClient) {\n    console.log(\"üü¢ ÏÉàÎ°úÏö¥ STOMP Client ÏÉùÏÑ±\");\n    stompClient = new Client({\n      brokerURL: \"ws://localhost:8082/ws\",\n      connectHeaders: {\n        Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n      },\n      debug: msg => console.log(\"üìå STOMP Debug:\", msg),\n      reconnectDelay: 5000,\n      // ‚úÖ 5Ï¥à ÌõÑ ÏûêÎèô Ïû¨Ïó∞Í≤∞\n      heartbeatIncoming: 4000,\n      heartbeatOutgoing: 4000\n    });\n    stompClient.onConnect = () => {\n      console.log(\"‚úÖ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ!\");\n      reconnectAttempts = 0; // ‚úÖ Ïû¨Ïó∞Í≤∞ ÌöüÏàò Ï¥àÍ∏∞Ìôî\n    };\n    stompClient.onStompError = frame => {\n      console.error(\"üö® STOMP Ïò§Î•ò Î∞úÏÉù:\", frame.headers[\"message\"]);\n    };\n    stompClient.onWebSocketError = error => {\n      console.error(\"üö® WebSocket Ïó∞Í≤∞ Ïò§Î•ò:\", error);\n      reconnectAttempts++;\n      if (reconnectAttempts >= MAX_RECONNECT_ATTEMPTS) {\n        console.warn(\"üõë ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ Ï¥àÍ≥º. WebSocket Ïû¨Ïó∞Í≤∞ Ï§ëÎã®.\");\n        stompClient.deactivate();\n      }\n    };\n    stompClient.onDisconnect = () => {\n      console.warn(\"‚ö†Ô∏è WebSocket Ïó∞Í≤∞ Ï¢ÖÎ£åÎê®!\");\n    };\n  } else {\n    console.log(\"‚ö†Ô∏è Í∏∞Ï°¥ STOMP ClientÍ∞Ä Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎØÄÎ°ú ÏÉàÎ°ú ÎßåÎì§ÏßÄ ÏïäÏùå.\");\n  }\n  return stompClient;\n};","map":{"version":3,"names":["Client","stompClient","reconnectAttempts","MAX_RECONNECT_ATTEMPTS","getStompClient","console","log","brokerURL","connectHeaders","Authorization","localStorage","getItem","debug","msg","reconnectDelay","heartbeatIncoming","heartbeatOutgoing","onConnect","onStompError","frame","error","headers","onWebSocketError","warn","deactivate","onDisconnect"],"sources":["/Users/woo/Documents/git_local/react/0213/src/api/websocket.js"],"sourcesContent":["import { Client } from \"@stomp/stompjs\";\n\nlet stompClient = null;\nlet reconnectAttempts = 0;\nconst MAX_RECONNECT_ATTEMPTS = 5; // ‚úÖ ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÌöüÏàò\n\nexport const getStompClient = () => {\n    if (!stompClient) {\n        console.log(\"üü¢ ÏÉàÎ°úÏö¥ STOMP Client ÏÉùÏÑ±\");\n        stompClient = new Client({\n            brokerURL: \"ws://localhost:8082/ws\",\n            connectHeaders: {\n                Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n            },\n            debug: (msg) => console.log(\"üìå STOMP Debug:\", msg),\n            reconnectDelay: 5000, // ‚úÖ 5Ï¥à ÌõÑ ÏûêÎèô Ïû¨Ïó∞Í≤∞\n            heartbeatIncoming: 4000,\n            heartbeatOutgoing: 4000,\n        });\n\n        stompClient.onConnect = () => {\n            console.log(\"‚úÖ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ!\");\n            reconnectAttempts = 0; // ‚úÖ Ïû¨Ïó∞Í≤∞ ÌöüÏàò Ï¥àÍ∏∞Ìôî\n        };\n\n        stompClient.onStompError = (frame) => {\n            console.error(\"üö® STOMP Ïò§Î•ò Î∞úÏÉù:\", frame.headers[\"message\"]);\n        };\n\n        stompClient.onWebSocketError = (error) => {\n            console.error(\"üö® WebSocket Ïó∞Í≤∞ Ïò§Î•ò:\", error);\n            reconnectAttempts++;\n            if (reconnectAttempts >= MAX_RECONNECT_ATTEMPTS) {\n                console.warn(\"üõë ÏµúÎåÄ Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ Ï¥àÍ≥º. WebSocket Ïû¨Ïó∞Í≤∞ Ï§ëÎã®.\");\n                stompClient.deactivate();\n            }\n        };\n\n        stompClient.onDisconnect = () => {\n            console.warn(\"‚ö†Ô∏è WebSocket Ïó∞Í≤∞ Ï¢ÖÎ£åÎê®!\");\n        };\n    } else {\n        console.log(\"‚ö†Ô∏è Í∏∞Ï°¥ STOMP ClientÍ∞Ä Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎØÄÎ°ú ÏÉàÎ°ú ÎßåÎì§ÏßÄ ÏïäÏùå.\");\n    }\n    \n    return stompClient;\n};\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,gBAAgB;AAEvC,IAAIC,WAAW,GAAG,IAAI;AACtB,IAAIC,iBAAiB,GAAG,CAAC;AACzB,MAAMC,sBAAsB,GAAG,CAAC,CAAC,CAAC;;AAElC,OAAO,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAChC,IAAI,CAACH,WAAW,EAAE;IACdI,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;IACrCL,WAAW,GAAG,IAAID,MAAM,CAAC;MACrBO,SAAS,EAAE,wBAAwB;MACnCC,cAAc,EAAE;QACZC,aAAa,EAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;MAChE,CAAC;MACDC,KAAK,EAAGC,GAAG,IAAKR,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEO,GAAG,CAAC;MACnDC,cAAc,EAAE,IAAI;MAAE;MACtBC,iBAAiB,EAAE,IAAI;MACvBC,iBAAiB,EAAE;IACvB,CAAC,CAAC;IAEFf,WAAW,CAACgB,SAAS,GAAG,MAAM;MAC1BZ,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;MACjCJ,iBAAiB,GAAG,CAAC,CAAC,CAAC;IAC3B,CAAC;IAEDD,WAAW,CAACiB,YAAY,GAAIC,KAAK,IAAK;MAClCd,OAAO,CAACe,KAAK,CAAC,iBAAiB,EAAED,KAAK,CAACE,OAAO,CAAC,SAAS,CAAC,CAAC;IAC9D,CAAC;IAEDpB,WAAW,CAACqB,gBAAgB,GAAIF,KAAK,IAAK;MACtCf,OAAO,CAACe,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;MAC3ClB,iBAAiB,EAAE;MACnB,IAAIA,iBAAiB,IAAIC,sBAAsB,EAAE;QAC7CE,OAAO,CAACkB,IAAI,CAAC,oCAAoC,CAAC;QAClDtB,WAAW,CAACuB,UAAU,CAAC,CAAC;MAC5B;IACJ,CAAC;IAEDvB,WAAW,CAACwB,YAAY,GAAG,MAAM;MAC7BpB,OAAO,CAACkB,IAAI,CAAC,sBAAsB,CAAC;IACxC,CAAC;EACL,CAAC,MAAM;IACHlB,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAC;EAC1D;EAEA,OAAOL,WAAW;AACtB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}