{"ast":null,"code":"import SockJS from \"sockjs-client\";\nimport { Client } from \"@stomp/stompjs\"; // ‚úÖ Ïò¨Î∞îÎ•∏ ÏûÑÌè¨Ìä∏\nimport axios from \"axios\";\nconst connectToChat = async () => {\n  try {\n    // 1Ô∏è‚É£ Secondary Token ÏöîÏ≤≠\n    const response = await axios.post(\"http://localhost:8082/api/user/secondary-token\", {}, {\n      withCredentials: true\n    });\n    const secondaryToken = response.data.secondaryToken;\n    console.log(\"‚úÖ Secondary Token:\", secondaryToken);\n\n    // 2Ô∏è‚É£ WebSocket Ïó∞Í≤∞ (Secondary Token Ìè¨Ìï®)\n    const socket = new SockJS(`http://localhost:8082/ws?secondaryToken=${secondaryToken}`);\n    const stompClient = Stomp.over(socket);\n\n    // 3Ô∏è‚É£ WebSocket Ïó∞Í≤∞ ÏãúÎèÑ\n    stompClient.connect({}, frame => {\n      console.log(\"üü¢ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ:\", frame);\n\n      // 4Ô∏è‚É£ ÌäπÏ†ï Ï±ÑÌåÖÎ∞© Íµ¨ÎèÖ (teamId = 1 ÏòàÏãú)\n      stompClient.subscribe(\"/topic/chat/1\", message => {\n        console.log(\"üì© ÏàòÏã†Îêú Î©îÏãúÏßÄ:\", JSON.parse(message.body));\n      });\n\n      // 5Ô∏è‚É£ Î©îÏãúÏßÄ Î≥¥ÎÇ¥Í∏∞ (ÏòàÏ†ú)\n      stompClient.send(\"/app/chat/send\", {}, JSON.stringify({\n        content: \"Hello Team!\",\n        teamId: 1\n      }));\n    }, error => {\n      console.error(\"‚õî WebSocket Ïó∞Í≤∞ Ïã§Ìå®:\", error);\n    });\n  } catch (error) {\n    console.error(\"‚ùå Secondary Token ÏöîÏ≤≠ Ïã§Ìå®:\", error);\n  }\n};\nexport default connectToChat;","map":{"version":3,"names":["SockJS","Client","axios","connectToChat","response","post","withCredentials","secondaryToken","data","console","log","socket","stompClient","Stomp","over","connect","frame","subscribe","message","JSON","parse","body","send","stringify","content","teamId","error"],"sources":["C:/project2/teamverse-2/src/utils/ConnectToChat.js"],"sourcesContent":["import SockJS from \"sockjs-client\";\r\nimport { Client } from \"@stomp/stompjs\"; // ‚úÖ Ïò¨Î∞îÎ•∏ ÏûÑÌè¨Ìä∏\r\nimport axios from \"axios\";\r\n\r\nconst connectToChat = async () => {\r\n  try {\r\n    // 1Ô∏è‚É£ Secondary Token ÏöîÏ≤≠\r\n    const response = await axios.post(\"http://localhost:8082/api/user/secondary-token\", {}, { withCredentials: true });\r\n    const secondaryToken = response.data.secondaryToken;\r\n\r\n    console.log(\"‚úÖ Secondary Token:\", secondaryToken);\r\n\r\n    // 2Ô∏è‚É£ WebSocket Ïó∞Í≤∞ (Secondary Token Ìè¨Ìï®)\r\n    const socket = new SockJS(`http://localhost:8082/ws?secondaryToken=${secondaryToken}`);\r\n    const stompClient = Stomp.over(socket);\r\n\r\n    // 3Ô∏è‚É£ WebSocket Ïó∞Í≤∞ ÏãúÎèÑ\r\n    stompClient.connect({}, (frame) => {\r\n      console.log(\"üü¢ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ:\", frame);\r\n\r\n      // 4Ô∏è‚É£ ÌäπÏ†ï Ï±ÑÌåÖÎ∞© Íµ¨ÎèÖ (teamId = 1 ÏòàÏãú)\r\n      stompClient.subscribe(\"/topic/chat/1\", (message) => {\r\n        console.log(\"üì© ÏàòÏã†Îêú Î©îÏãúÏßÄ:\", JSON.parse(message.body));\r\n      });\r\n\r\n      // 5Ô∏è‚É£ Î©îÏãúÏßÄ Î≥¥ÎÇ¥Í∏∞ (ÏòàÏ†ú)\r\n      stompClient.send(\"/app/chat/send\", {}, JSON.stringify({\r\n        content: \"Hello Team!\",\r\n        teamId: 1\r\n      }));\r\n\r\n    }, (error) => {\r\n      console.error(\"‚õî WebSocket Ïó∞Í≤∞ Ïã§Ìå®:\", error);\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error(\"‚ùå Secondary Token ÏöîÏ≤≠ Ïã§Ìå®:\", error);\r\n  }\r\n};\r\n\r\nexport default connectToChat;\r\n"],"mappings":"AAAA,OAAOA,MAAM,MAAM,eAAe;AAClC,SAASC,MAAM,QAAQ,gBAAgB,CAAC,CAAC;AACzC,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,aAAa,GAAG,MAAAA,CAAA,KAAY;EAChC,IAAI;IACF;IACA,MAAMC,QAAQ,GAAG,MAAMF,KAAK,CAACG,IAAI,CAAC,gDAAgD,EAAE,CAAC,CAAC,EAAE;MAAEC,eAAe,EAAE;IAAK,CAAC,CAAC;IAClH,MAAMC,cAAc,GAAGH,QAAQ,CAACI,IAAI,CAACD,cAAc;IAEnDE,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEH,cAAc,CAAC;;IAEjD;IACA,MAAMI,MAAM,GAAG,IAAIX,MAAM,CAAC,2CAA2CO,cAAc,EAAE,CAAC;IACtF,MAAMK,WAAW,GAAGC,KAAK,CAACC,IAAI,CAACH,MAAM,CAAC;;IAEtC;IACAC,WAAW,CAACG,OAAO,CAAC,CAAC,CAAC,EAAGC,KAAK,IAAK;MACjCP,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEM,KAAK,CAAC;;MAEzC;MACAJ,WAAW,CAACK,SAAS,CAAC,eAAe,EAAGC,OAAO,IAAK;QAClDT,OAAO,CAACC,GAAG,CAAC,aAAa,EAAES,IAAI,CAACC,KAAK,CAACF,OAAO,CAACG,IAAI,CAAC,CAAC;MACtD,CAAC,CAAC;;MAEF;MACAT,WAAW,CAACU,IAAI,CAAC,gBAAgB,EAAE,CAAC,CAAC,EAAEH,IAAI,CAACI,SAAS,CAAC;QACpDC,OAAO,EAAE,aAAa;QACtBC,MAAM,EAAE;MACV,CAAC,CAAC,CAAC;IAEL,CAAC,EAAGC,KAAK,IAAK;MACZjB,OAAO,CAACiB,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;IAC5C,CAAC,CAAC;EAEJ,CAAC,CAAC,OAAOA,KAAK,EAAE;IACdjB,OAAO,CAACiB,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;EAClD;AACF,CAAC;AAED,eAAevB,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}