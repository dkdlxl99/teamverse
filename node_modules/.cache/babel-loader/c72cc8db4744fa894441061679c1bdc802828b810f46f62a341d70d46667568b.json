{"ast":null,"code":"import { Client } from \"@stomp/stompjs\"; // ‚úÖ Ïò¨Î∞îÎ•∏ ÏûÑÌè¨Ìä∏\nimport axios from \"axios\";\nconst connectToChat = async () => {\n  try {\n    // 1Ô∏è‚É£ Secondary Token ÏöîÏ≤≠\n    const response = await axios.post(\"http://localhost:8082/api/user/secondary-token\", {}, {\n      withCredentials: true\n    });\n    const secondaryToken = response.data.secondaryToken;\n    console.log(\"‚úÖ Secondary Token:\", secondaryToken);\n\n    // 2Ô∏è‚É£ WebSocket Ïó∞Í≤∞ (Secondary Token Ìè¨Ìï®)\n    const client = new Client({\n      brokerURL: `ws://localhost:8082/ws?secondaryToken=${secondaryToken}`,\n      reconnectDelay: 5000,\n      onConnect: frame => {\n        console.log(\"üü¢ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ:\", frame);\n\n        // 3Ô∏è‚É£ ÌäπÏ†ï Ï±ÑÌåÖÎ∞© Íµ¨ÎèÖ (teamId = 1 ÏòàÏãú)\n        client.subscribe(\"/topic/chat/1\", message => {\n          console.log(\"üì© ÏàòÏã†Îêú Î©îÏãúÏßÄ:\", JSON.parse(message.body));\n        });\n\n        // 4Ô∏è‚É£ Î©îÏãúÏßÄ Î≥¥ÎÇ¥Í∏∞ (ÏòàÏ†ú) - ‚úÖ ÏàòÏ†ïÎê®\n        client.publish({\n          destination: \"/app/chat/send\",\n          headers: {},\n          // ‚úÖ `headers` Ï∂îÍ∞Ä (ÌïÑÏàò)\n          body: JSON.stringify({\n            content: \"Hello Team!\",\n            teamId: 1\n          })\n        });\n      },\n      onStompError: frame => {\n        console.error(\"‚õî WebSocket Ïó∞Í≤∞ Ïã§Ìå®:\", frame);\n      }\n    });\n    client.activate(); // ‚úÖ WebSocket ÌôúÏÑ±Ìôî\n  } catch (error) {\n    console.error(\"‚ùå Secondary Token ÏöîÏ≤≠ Ïã§Ìå®:\", error);\n  }\n};\nexport default connectToChat;","map":{"version":3,"names":["Client","axios","connectToChat","response","post","withCredentials","secondaryToken","data","console","log","client","brokerURL","reconnectDelay","onConnect","frame","subscribe","message","JSON","parse","body","publish","destination","headers","stringify","content","teamId","onStompError","error","activate"],"sources":["C:/project2/teamverse-2/src/utils/ConnectToChat.js"],"sourcesContent":["import { Client } from \"@stomp/stompjs\"; // ‚úÖ Ïò¨Î∞îÎ•∏ ÏûÑÌè¨Ìä∏\r\nimport axios from \"axios\";\r\n\r\nconst connectToChat = async () => {\r\n  try {\r\n    // 1Ô∏è‚É£ Secondary Token ÏöîÏ≤≠\r\n    const response = await axios.post(\"http://localhost:8082/api/user/secondary-token\", {}, { withCredentials: true });\r\n    const secondaryToken = response.data.secondaryToken;\r\n\r\n    console.log(\"‚úÖ Secondary Token:\", secondaryToken);\r\n\r\n    // 2Ô∏è‚É£ WebSocket Ïó∞Í≤∞ (Secondary Token Ìè¨Ìï®)\r\n    const client = new Client({\r\n      brokerURL: `ws://localhost:8082/ws?secondaryToken=${secondaryToken}`,\r\n      reconnectDelay: 5000,\r\n      onConnect: (frame) => {\r\n        console.log(\"üü¢ WebSocket Ïó∞Í≤∞ ÏÑ±Í≥µ:\", frame);\r\n\r\n        // 3Ô∏è‚É£ ÌäπÏ†ï Ï±ÑÌåÖÎ∞© Íµ¨ÎèÖ (teamId = 1 ÏòàÏãú)\r\n        client.subscribe(\"/topic/chat/1\", (message) => {\r\n          console.log(\"üì© ÏàòÏã†Îêú Î©îÏãúÏßÄ:\", JSON.parse(message.body));\r\n        });\r\n\r\n        // 4Ô∏è‚É£ Î©îÏãúÏßÄ Î≥¥ÎÇ¥Í∏∞ (ÏòàÏ†ú) - ‚úÖ ÏàòÏ†ïÎê®\r\n        client.publish({\r\n          destination: \"/app/chat/send\",\r\n          headers: {}, // ‚úÖ `headers` Ï∂îÍ∞Ä (ÌïÑÏàò)\r\n          body: JSON.stringify({\r\n            content: \"Hello Team!\",\r\n            teamId: 1\r\n          })\r\n        });\r\n      },\r\n      onStompError: (frame) => {\r\n        console.error(\"‚õî WebSocket Ïó∞Í≤∞ Ïã§Ìå®:\", frame);\r\n      }\r\n    });\r\n\r\n    client.activate(); // ‚úÖ WebSocket ÌôúÏÑ±Ìôî\r\n\r\n  } catch (error) {\r\n    console.error(\"‚ùå Secondary Token ÏöîÏ≤≠ Ïã§Ìå®:\", error);\r\n  }\r\n};\r\n\r\nexport default connectToChat;\r\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,gBAAgB,CAAC,CAAC;AACzC,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,aAAa,GAAG,MAAAA,CAAA,KAAY;EAChC,IAAI;IACF;IACA,MAAMC,QAAQ,GAAG,MAAMF,KAAK,CAACG,IAAI,CAAC,gDAAgD,EAAE,CAAC,CAAC,EAAE;MAAEC,eAAe,EAAE;IAAK,CAAC,CAAC;IAClH,MAAMC,cAAc,GAAGH,QAAQ,CAACI,IAAI,CAACD,cAAc;IAEnDE,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEH,cAAc,CAAC;;IAEjD;IACA,MAAMI,MAAM,GAAG,IAAIV,MAAM,CAAC;MACxBW,SAAS,EAAE,yCAAyCL,cAAc,EAAE;MACpEM,cAAc,EAAE,IAAI;MACpBC,SAAS,EAAGC,KAAK,IAAK;QACpBN,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEK,KAAK,CAAC;;QAEzC;QACAJ,MAAM,CAACK,SAAS,CAAC,eAAe,EAAGC,OAAO,IAAK;UAC7CR,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEQ,IAAI,CAACC,KAAK,CAACF,OAAO,CAACG,IAAI,CAAC,CAAC;QACtD,CAAC,CAAC;;QAEF;QACAT,MAAM,CAACU,OAAO,CAAC;UACbC,WAAW,EAAE,gBAAgB;UAC7BC,OAAO,EAAE,CAAC,CAAC;UAAE;UACbH,IAAI,EAAEF,IAAI,CAACM,SAAS,CAAC;YACnBC,OAAO,EAAE,aAAa;YACtBC,MAAM,EAAE;UACV,CAAC;QACH,CAAC,CAAC;MACJ,CAAC;MACDC,YAAY,EAAGZ,KAAK,IAAK;QACvBN,OAAO,CAACmB,KAAK,CAAC,oBAAoB,EAAEb,KAAK,CAAC;MAC5C;IACF,CAAC,CAAC;IAEFJ,MAAM,CAACkB,QAAQ,CAAC,CAAC,CAAC,CAAC;EAErB,CAAC,CAAC,OAAOD,KAAK,EAAE;IACdnB,OAAO,CAACmB,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;EAClD;AACF,CAAC;AAED,eAAezB,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}